using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace KH_NET_UI
{
    /// <summary>
    /// Interaction logic for GameSelectControl.xaml
    /// </summary>
    public partial class GameSelectControl : UserControl
    {
        public delegate void RequestSwitchHandler(object sender, RequestSwitchArgs e);
        public event RequestSwitchHandler RequestSwitchEvent;

        BackgroundWorker GameSearchWorker = new BackgroundWorker();
        public GameSelectControl()
        {
            InitializeComponent();
            SelectedGameID = -1;
            GameSearchWorker.DoWork += GameSearchWorker_DoWork;
            GameSearchWorker.RunWorkerCompleted += GameSearchWorker_RunWorkerCompleted;
        }

        private void GameSearchWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            UpdateFromString((string)e.Result);
        }

        private void GameSearchWorker_DoWork(object sender, DoWorkEventArgs e)
        {
            BackgroundWorker_Work bw = new BackgroundWorker_Work();
            string res = bw.GameSearchWork((string)e.Argument);
            e.Result = res;
        }

        public int SelectedGameID { get; private set; }
        public void UpdateFromString(string res)
        {
            //res = "[{\"id\":35117,\"name\":\"WetDike\",\"desc\":\"A version of klondike \\/ patience \\/ solitaire . Sort the card\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000000025-32.png\",\"created\":\"03\\/16\\/2012\",\"url\":\"\\/game\\/display\\/25-wetdike\"},{\"id\":167093,\"name\":\"PlanetDefender\",\"desc\":\"Protect the planet from waves of alien invaders by building \",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000000133-32.png\",\"created\":\"03\\/16\\/2012\",\"url\":\"\\/game\\/display\\/133-planetdefender\"},{\"id\":367501,\"name\":\"Desktop TD Pro\",\"desc\":\"Long time coming, but it&#8217;s finally here. Desktop TD Pr\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000000297-32.png\",\"created\":\"03\\/16\\/2012\",\"url\":\"\\/game\\/display\\/297-desktop_td_pro\"},{\"id\":473815,\"name\":\"mini Tower Defence (mTD)\",\"desc\":\"Do you like defence games? Have you tried mini Tower Defence\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000000384-32.png\",\"created\":\"03\\/16\\/2012\",\"url\":\"\\/game\\/display\\/384-mini_tower_defence_mtd\"},{\"id\":555689,\"name\":\"Bubble Tanks TD 1.5\",\"desc\":\"Bubble Tanks TD 1.5, a free online Strategy game brought to \",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000000451-32.png\",\"created\":\"03\\/16\\/2012\",\"url\":\"\\/game\\/display\\/451-bubble_tanks_td_15\"},{\"id\":793979,\"name\":\"Castaway Island TD\",\"desc\":\"This Castaway spin-off combines real-time adventure with the\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000000646-32.png\",\"created\":\"03\\/16\\/2012\",\"url\":\"\\/game\\/display\\/646-castaway_island_td\"},{\"id\":829417,\"name\":\"Demonrift TD\",\"desc\":\"Defend the kingdom of Emaeron from demonic surge all over th\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000000675-32.png\",\"created\":\"03\\/16\\/2012\",\"url\":\"\\/game\\/display\\/675-demonrift_td\"},{\"id\":960171,\"name\":\"Create your own TD 3\",\"desc\":\"Make your very own tower defense game!!! Create your Own TD \",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000000782-32.png\",\"created\":\"04\\/01\\/2012\",\"url\":\"\\/game\\/display\\/782-create_your_own_td_3\"},{\"id\":1437973,\"name\":\"Penguins Attack TD 2\",\"desc\":\"Once again the penguins are waging war on the human race.. W\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000001173-32.png\",\"created\":\"05\\/27\\/2012\",\"url\":\"\\/game\\/display\\/1173-penguins_attack_td_2\"},{\"id\":1783799,\"name\":\"Bowels Physics TD\",\"desc\":\"A mix of TD and physics genres. Your goal is to prevent germ\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000001456-32.png\",\"created\":\"07\\/26\\/2012\",\"url\":\"\\/game\\/display\\/1456-bowels_physics_td\"},{\"id\":2031865,\"name\":\"CreepTD - Online Multiplayer Tower Defense\",\"desc\":\"CreepTD is the best rated and most played Online Multiplayer\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000001659-32.png\",\"created\":\"08\\/31\\/2012\",\"url\":\"\\/game\\/display\\/1659-creeptd__online_multiplayer_tower_defense\"},{\"id\":2202945,\"name\":\"HTD: Collection 002\",\"desc\":\"Learn how to draw with twelve tutorials and three extra tuto\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000001799-32.png\",\"created\":\"09\\/23\\/2012\",\"url\":\"\\/game\\/display\\/1799-htd_collection_002\"},{\"id\":2220053,\"name\":\"SAS Zombie Assault TD\",\"desc\":\"Hordes of undead are approaching! Your mission is to stop th\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000001813-32.png\",\"created\":\"09\\/25\\/2012\",\"url\":\"\\/game\\/display\\/1813-sas_zombie_assault_td\"},{\"id\":2272599,\"name\":\"Pokemon TD\",\"desc\":\"You Use Pokemon as Defence towers and upgrade them and selec\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000001856-32.png\",\"created\":\"09\\/27\\/2012\",\"url\":\"\\/game\\/display\\/1856-pokemon_td\"},{\"id\":2303149,\"name\":\"Starland Multiplayer TD\",\"desc\":\"A multiplayer tower defense game. Play against a friend and \",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000001881-32.png\",\"created\":\"10\\/01\\/2012\",\"url\":\"\\/game\\/display\\/1881-starland_multiplayer_td\"},{\"id\":2385023,\"name\":\"WetDiamonds\",\"desc\":\"Match Three\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000001948-32.png\",\"created\":\"10\\/07\\/2012\",\"url\":\"\\/game\\/display\\/1948-wetdiamonds\"},{\"id\":2580543,\"name\":\"Flash Element TD 2\",\"desc\":\"Flash Element TD 2 is the sequel to one of the most popular \",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000002108-32.png\",\"created\":\"10\\/20\\/2012\",\"url\":\"\\/game\\/display\\/2108-flash_element_td_2\"},{\"id\":3272195,\"name\":\"Trojan War TD 2\",\"desc\":\"In the tower defense game Trojan War TD your duty is to prot\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000002674-32.png\",\"created\":\"11\\/25\\/2012\",\"url\":\"\\/game\\/display\\/2674-trojan_war_td_2\"},{\"id\":3763439,\"name\":\"vector TD\",\"desc\":\"no more game\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000003076-32.png\",\"created\":\"12\\/26\\/2012\",\"url\":\"\\/game\\/display\\/3076-vector_td\"},{\"id\":3933297,\"name\":\"Snow Virus TD\",\"desc\":\"An evil AI has taken over the military forces of a space col\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000003215-32.png\",\"created\":\"01\\/03\\/2013\",\"url\":\"\\/game\\/display\\/3215-snow_virus_td\"},{\"id\":4007839,\"name\":\"Monsters TD 2\",\"desc\":\"Defend your base from a series of weird and freaky monsters.\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000003276-32.png\",\"created\":\"01\\/07\\/2013\",\"url\":\"\\/game\\/display\\/3276-monsters_td_2\"},{\"id\":4028613,\"name\":\"Easter Island TD\",\"desc\":\"The famous stone heads on Easter Island are being ravaged by\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000003293-32.png\",\"created\":\"01\\/08\\/2013\",\"url\":\"\\/game\\/display\\/3293-easter_island_td\"},{\"id\":4191139,\"name\":\"Countdown Letters\",\"desc\":\"Race the clock and spell the longest possible word.\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000003426-32.png\",\"created\":\"01\\/19\\/2013\",\"url\":\"\\/game\\/display\\/3426-countdown_letters\"},{\"id\":4297453,\"name\":\"Pokemon Invaders TD\",\"desc\":\"It\\u00e2\\u20ac\\u2122s tower defense game, with Pokemon and Team Rocket\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000003513-32.png\",\"created\":\"01\\/30\\/2013\",\"url\":\"\\/game\\/display\\/3513-pokemon_invaders_td\"},{\"id\":4328003,\"name\":\"Expendables 2: TD\",\"desc\":\"Kick some ass with the Expendables 2: Deploy &amp; Destroy T\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000003538-32.png\",\"created\":\"02\\/02\\/2013\",\"url\":\"\\/game\\/display\\/3538-expendables_2_td\"},{\"id\":4657943,\"name\":\"Flash Element TD\",\"desc\":\"Kill the creep waves by building and upgrading towers along \",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000003808-32.png\",\"created\":\"03\\/04\\/2013\",\"url\":\"\\/game\\/display\\/3808-flash_element_td\"},{\"id\":5161407,\"name\":\"Dress up kawaii totd\",\"desc\":\"I need a new style  ( It&#x27;s my first game, please don&#x\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000004220-32.png\",\"created\":\"03\\/17\\/2013\",\"url\":\"\\/game\\/display\\/4220-dress_up_kawaii_totd\"},{\"id\":5773629,\"name\":\"Old School TD\",\"desc\":\"An on school TD by Creating Genres. All images courtesy of O\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000004721-32.png\",\"created\":\"04\\/05\\/2013\",\"url\":\"\\/game\\/display\\/4721-old_school_td\"},{\"id\":5845727,\"name\":\"Zombie TD\",\"desc\":\"Zombie TD is a tower defense game. Start your Campaign to St\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000004780-32.png\",\"created\":\"04\\/05\\/2013\",\"url\":\"\\/game\\/display\\/4780-zombie_td\"},{\"id\":5996033,\"name\":\"MTD 3D\",\"desc\":\"Hard Tower Defense game. Final project developed for college\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000004903-32.png\",\"created\":\"04\\/05\\/2013\",\"url\":\"\\/game\\/display\\/4903-mtd_3d\"},{\"id\":6073019,\"name\":\"TDP5\",\"desc\":\"its going to be sick. Play TDP5\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000004966-32.png\",\"created\":\"04\\/08\\/2013\",\"url\":\"\\/game\\/display\\/4966-tdp5\"},{\"id\":6076685,\"name\":\"TDP4 Combo Streaks Sounds\",\"desc\":\"Ever wonder how combo sounds, sounded like? Now you can hear\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000004969-32.png\",\"created\":\"04\\/08\\/2013\",\"url\":\"\\/game\\/display\\/4969-tdp4_combo_streaks_sounds\"},{\"id\":6349191,\"name\":\"Anti-TD\",\"desc\":\"This game is opposite to normal Tower Defense games. Instead\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000005192-32.png\",\"created\":\"04\\/20\\/2013\",\"url\":\"\\/game\\/display\\/5192-antitd\"},{\"id\":6351635,\"name\":\"Countdown with Neil Haversham\",\"desc\":\"1 Programmer, 1 Artist, 8hours, surely nothing of any qualit\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000005194-32.png\",\"created\":\"04\\/20\\/2013\",\"url\":\"\\/game\\/display\\/5194-countdown_with_neil_haversham\"},{\"id\":6826993,\"name\":\"Echos of Sarnath TD - A Prologue\",\"desc\":\"You have been charged with the protection of Sarnath. Build \",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000005583-32.png\",\"created\":\"05\\/01\\/2013\",\"url\":\"\\/game\\/display\\/5583-echos_of_sarnath_td__a_prologue\"},{\"id\":7048175,\"name\":\"Blue World TD 2\",\"desc\":\"Protect your planet !!!\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000005764-32.png\",\"created\":\"05\\/06\\/2013\",\"url\":\"\\/game\\/display\\/5764-blue_world_td_2\"},{\"id\":7494205,\"name\":\"Spectrum TD\",\"desc\":\"A well polished tower defense game where you buy, place and \",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000006129-32.png\",\"created\":\"05\\/10\\/2013\",\"url\":\"\\/game\\/display\\/6129-spectrum_td\"},{\"id\":7607851,\"name\":\"NeoCon TD\",\"desc\":\"NeoCon TD new type of Tower Defense Game.\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000006222-32.png\",\"created\":\"05\\/11\\/2013\",\"url\":\"\\/game\\/display\\/6222-neocon_td\"},{\"id\":7648177,\"name\":\"Core Meltdown\",\"desc\":\"Hector must escape the core meltdown on the space station.\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000006255-32.png\",\"created\":\"05\\/12\\/2013\",\"url\":\"\\/game\\/display\\/6255-core_meltdown\"},{\"id\":7727607,\"name\":\"Creepy Ranger TD\",\"desc\":\"an unique Halloween theme tower defense game just enjoy my g\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000006320-32.png\",\"created\":\"05\\/12\\/2013\",\"url\":\"\\/game\\/display\\/6320-creepy_ranger_td\"},{\"id\":8231071,\"name\":\"Condemned World TD\",\"desc\":\"The world is under attack from the most gruesome monsters he\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000006732-32.png\",\"created\":\"05\\/20\\/2013\",\"url\":\"\\/game\\/display\\/6732-condemned_world_td\"},{\"id\":8275063,\"name\":\"Cobra Squad TD\",\"desc\":\"Cobra Squad will face the ranks of the enemy forces, put you\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000006768-32.png\",\"created\":\"05\\/23\\/2013\",\"url\":\"\\/game\\/display\\/6768-cobra_squad_td\"},{\"id\":8644107,\"name\":\"Anti Colour TD 2\",\"desc\":\"TD game. Play Anti Colour TD 2\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000007070-32.png\",\"created\":\"05\\/31\\/2013\",\"url\":\"\\/game\\/display\\/7070-anti_colour_td_2\"},{\"id\":8662437,\"name\":\"TD Advance\",\"desc\":\"Destroy all before they can reach the city.. Play TD Advance\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000007085-32.png\",\"created\":\"05\\/31\\/2013\",\"url\":\"\\/game\\/display\\/7085-td_advance\"},{\"id\":8908059,\"name\":\"BattleMage TD\",\"desc\":\"BattleMage TD is a 1on1, multi-player tower defense battle. \",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000007286-32.png\",\"created\":\"06\\/02\\/2013\",\"url\":\"\\/game\\/display\\/7286-battlemage_td\"},{\"id\":8910503,\"name\":\"Mitdown Madness (TRIAL)\",\"desc\":\"Race a Game Mitdown Madness Trial Version 3 If You Timed Up \",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000007288-32.png\",\"created\":\"06\\/02\\/2013\",\"url\":\"\\/game\\/display\\/7288-mitdown_madness_trial\"},{\"id\":8936165,\"name\":\"MyFirstDemo\",\"desc\":\"MyFirstDemo. Play MyFirstDemo\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000007309-32.png\",\"created\":\"06\\/03\\/2013\",\"url\":\"\\/game\\/display\\/7309-myfirstdemo\"},{\"id\":9108467,\"name\":\"Garden TD\",\"desc\":\"Defend your garden from bugs by placing gnomes,poisoned ball\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000007450-32.png\",\"created\":\"06\\/08\\/2013\",\"url\":\"\\/game\\/display\\/7450-garden_td\"},{\"id\":9426187,\"name\":\"Practice TD\",\"desc\":\"It&#x27;s a TD I worked on to teach myself flash.  Place tow\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000007710-32.png\",\"created\":\"06\\/12\\/2013\",\"url\":\"\\/game\\/display\\/7710-practice_td\"},{\"id\":9691361,\"name\":\"TDefense (Beta)\",\"desc\":\"T*Defense (Beta) is a third-person \\/ birds-eye view 3d turre\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000007927-32.png\",\"created\":\"06\\/12\\/2013\",\"url\":\"\\/game\\/display\\/7927-tdefense_beta\"},{\"id\":10101953,\"name\":\"Doodle Bug TD\",\"desc\":\"Tower defense action! Fight off the waves of evil bugs, flie\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000008263-32.png\",\"created\":\"06\\/17\\/2013\",\"url\":\"\\/game\\/display\\/8263-doodle_bug_td\"},{\"id\":10711731,\"name\":\"Monsters TD\",\"desc\":\"You are in charge of defending the tower. Monsters are on th\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000008762-32.png\",\"created\":\"07\\/06\\/2013\",\"url\":\"\\/game\\/display\\/8762-monsters_td\"},{\"id\":10860815,\"name\":\"Inferno 2: Meltdown\",\"desc\":\"So you always wanted to be a fire-fighter? Well now&#x27;s y\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000008884-32.png\",\"created\":\"07\\/14\\/2013\",\"url\":\"\\/game\\/display\\/8884-inferno_2_meltdown\"},{\"id\":10901141,\"name\":\"Newgrounds Portal-TD\",\"desc\":\"Newgrounds characters come together to defend their homeland\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000008917-32.png\",\"created\":\"07\\/16\\/2013\",\"url\":\"\\/game\\/display\\/8917-newgrounds_portaltd\"},{\"id\":11299513,\"name\":\"Revolutionary War TD\",\"desc\":\"In the game, you will command your army against the most pow\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000009243-32.png\",\"created\":\"08\\/04\\/2013\",\"url\":\"\\/game\\/display\\/9243-revolutionary_war_td\"},{\"id\":11365501,\"name\":\"Born of Fire TD\",\"desc\":\"Follow Sorgal, the Exiled Demon, in his crusade against Hell\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000009297-32.png\",\"created\":\"08\\/08\\/2013\",\"url\":\"\\/game\\/display\\/9297-born_of_fire_td\"},{\"id\":11710105,\"name\":\"Creat your own TD 2\",\"desc\":\"Creat your own TD! Can you make the My Tower Defense Games w\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000009579-32.png\",\"created\":\"08\\/11\\/2013\",\"url\":\"\\/game\\/display\\/9579-creat_your_own_td_2\"},{\"id\":11923955,\"name\":\"Wyzau Circle TD\",\"desc\":\"Take the challenge! The task is simple: Survive 35 waves. If\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000009754-32.png\",\"created\":\"08\\/18\\/2013\",\"url\":\"\\/game\\/display\\/9754-wyzau_circle_td\"},{\"id\":12027825,\"name\":\"Unamed Dungeon Game - GitD #30 Entry\",\"desc\":\"My entry for the 30th  Game in Ten Days contest :D The theme\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000009839-32.png\",\"created\":\"08\\/21\\/2013\",\"url\":\"\\/game\\/display\\/9839-unamed_dungeon_game__gitd_30_entry\"},{\"id\":12468967,\"name\":\"Spider TD\",\"desc\":\"Spider TD is a mix of tower defense and arcade styles. The m\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000010200-32.png\",\"created\":\"09\\/07\\/2013\",\"url\":\"\\/game\\/display\\/10200-spider_td\"},{\"id\":12532511,\"name\":\"Phase TD\",\"desc\":\"Alien life forms have been detected near your planet. Your a\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000010252-32.png\",\"created\":\"09\\/09\\/2013\",\"url\":\"\\/game\\/display\\/10252-phase_td\"},{\"id\":13165507,\"name\":\"In ten seconds can you...? GiTD 35\",\"desc\":\"In ten seconds, can you... destroy your mouse by clicking an\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000010770-32.png\",\"created\":\"09\\/25\\/2013\",\"url\":\"\\/game\\/display\\/10770-in_ten_seconds_can_you_gitd_35\"},{\"id\":13708075,\"name\":\"Colony Defenders TD\",\"desc\":\"Build strong defenses and lead your troops to victory agains\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000011214-32.png\",\"created\":\"10\\/10\\/2013\",\"url\":\"\\/game\\/display\\/11214-colony_defenders_td\"},{\"id\":14688119,\"name\":\"The Rock Beatdown\",\"desc\":\"It doesnt matter what the rock says!!!!  Kick his ASS!\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000012016-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/12016-the_rock_beatdown\"},{\"id\":14754107,\"name\":\"Gwen TDI (ADULT)\",\"desc\":\"Gwen (Total Drama Island) interactive hentai.\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000012070-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/12070-gwen_tdi_adult\"},{\"id\":14934963,\"name\":\"Flashcraft - TD\",\"desc\":\"Build towers and destroy enemy armies in this Warcraft Tower\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000012218-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/12218-flashcraft__td\"},{\"id\":15079159,\"name\":\"Galatic Ship Repairs Ltd\",\"desc\":\"Have you got what it takes to be the best space ship navigat\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000012336-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/12336-galatic_ship_repairs_ltd\"},{\"id\":15495861,\"name\":\"Hands of War TD\",\"desc\":\"Can you defend your nation against an invading force and uni\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000012677-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/12677-hands_of_war_td\"},{\"id\":16049427,\"name\":\"MagicTD\",\"desc\":\"game completed 20% and need sponsor\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000013130-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/13130-magictd\"},{\"id\":16574887,\"name\":\"miniTowerDefencePlus mTD+\",\"desc\":\"Do you like defence games? Have you tried mini Tower Defence\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000013560-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/13560-minitowerdefenceplus_mtd\"},{\"id\":17161447,\"name\":\"Symphonic TD - Halloween\",\"desc\":\"Conduct even harder against a spooky new set of music! Don't\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000014040-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/14040-symphonic_td__halloween\"},{\"id\":17524381,\"name\":\"OutPostDedlaw: SpaceGAME!\",\"desc\":\"A Space shooting game!!!\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000014337-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/14337-outpostdedlaw_spacegame\"},{\"id\":17705237,\"name\":\"When Penguins Attack - TD\",\"desc\":\"Save the human race from the onslaught of the evil warmonger\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000014485-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/14485-when_penguins_attack__td\"},{\"id\":17738231,\"name\":\"Period TD\",\"desc\":\"A quick flash tower defense - low quality. Lots'a penis.\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000014512-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/14512-period_td\"},{\"id\":17945971,\"name\":\"Bighouse Beatdown\",\"desc\":\"Now you&rsquo;ve done it! You screwed up and got yourself th\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000014682-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/14682-bighouse_beatdown\"},{\"id\":19026219,\"name\":\"Fratboy Girlfriend TD\",\"desc\":\"Defend your girlfriend with towers and weapons against the i\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000015566-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/15566-fratboy_girlfriend_td\"},{\"id\":19215629,\"name\":\"Bloons TD4 Expansion\",\"desc\":\"Bloons Tower Defense 4 Expansion contains 4 brand new crazy \",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000015721-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/15721-bloons_td4_expansion\"},{\"id\":19946385,\"name\":\"Monster TD\",\"desc\":\"A shooting stratergy game where you can destroy monsters and\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000016319-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/16319-monster_td\"},{\"id\":20095469,\"name\":\"TreeTD: Tree TowerDefence\",\"desc\":\"Tree Tower Defence - A Unique Tower Defence game where you b\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000016441-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/16441-treetd_tree_towerdefence\"},{\"id\":20763903,\"name\":\"Zombie TD: Reborn\",\"desc\":\"Annihilate these ugly undead assassins with your trusty high\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000016988-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/16988-zombie_td_reborn\"},{\"id\":21967573,\"name\":\"Bad Wolfs TD\",\"desc\":\"help feed cute hungry wolfs\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000017973-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/17973-bad_wolfs_td\"},{\"id\":22633563,\"name\":\"Clear Waters TD\",\"desc\":\"Build towers to kill monsters\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000018518-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/18518-clear_waters_td\"},{\"id\":22926843,\"name\":\"IWBTD\",\"desc\":\"The hardest game ever made\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000018758-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/18758-iwbtd\"},{\"id\":23058819,\"name\":\"Enigmata TD\",\"desc\":\"Build up a base to save the Enigmata galaxy from the insidio\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000018866-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/18866-enigmata_td\"},{\"id\":23264115,\"name\":\"Star Temple TD Demo\",\"desc\":\"An intense sci-fi tower defense game.\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000019034-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/19034-star_temple_td_demo\"},{\"id\":24021755,\"name\":\"Minecraft TD (old)\",\"desc\":\"Think you can you hold down hundreds of hungry mobs and then\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000019654-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/19654-minecraft_td_old\"},{\"id\":24987135,\"name\":\"Massive Space TD\",\"desc\":\"Massive tower defense game!\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000020444-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/20444-massive_space_td\"},{\"id\":25069009,\"name\":\"Raver Meltdown\",\"desc\":\"Worst rave ever!\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000020511-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/20511-raver_meltdown\"},{\"id\":25164325,\"name\":\"Create your own TD 2\",\"desc\":\"Create your very own tower defense game and upload to a port\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000020589-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/20589-create_your_own_td_2\"},{\"id\":25895081,\"name\":\"Stark Tower Defense TD\",\"desc\":\"Dr. Doom and the Lethal Legion are launching a major assault\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000021187-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/21187-stark_tower_defense_td\"},{\"id\":26589177,\"name\":\"Brother (ltdesign)\",\"desc\":\"A cute game in which you explore the mountains and solve puz\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000021755-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/21755-brother_ltdesign\"},{\"id\":139526417,\"name\":\"Judge Dredd: Countdown Sector 106\",\"desc\":\"  \\t\\t\\t\\t\\t\\tAbout This Game  \\t\\t\\t\\t\\t\\tWhat begins as a routine patr\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000114175-32.png\",\"created\":\"04\\/24\\/2015\",\"url\":\"\\/game\\/display\\/114175-judge_dredd_countdown_sector_106\"},{\"id\":27186735,\"name\":\"Halloween Beatdown\",\"desc\":\"Help our heroine fight off the monsters and defeat the sourc\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000022244-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/22244-halloween_beatdown\"},{\"id\":27415249,\"name\":\"MyFirstDressUp Game\",\"desc\":\"The Lois G. Dress-Up Game\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000022431-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/22431-myfirstdressup_game\"},{\"id\":27554557,\"name\":\"Space Invasion TD 2\",\"desc\":\"Defend against 10 levels of invaders\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000022545-32.png\",\"created\":\"10\\/12\\/2013\",\"url\":\"\\/game\\/display\\/22545-space_invasion_td_2\"},{\"id\":28183887,\"name\":\"Ninjas vs. Pirates TD\",\"desc\":\"Build Ninjas and defend against pirates\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000023060-32.png\",\"created\":\"10\\/13\\/2013\",\"url\":\"\\/game\\/display\\/23060-ninjas_vs_pirates_td\"},{\"id\":29993669,\"name\":\"TD: Destroy the Toy\",\"desc\":\"A classic tower defence game with a christmas theme.\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000024541-32.png\",\"created\":\"10\\/13\\/2013\",\"url\":\"\\/game\\/display\\/24541-td_destroy_the_toy\"},{\"id\":30071877,\"name\":\"YHTDUKB\",\"desc\":\"Free Harry Nicolaides!\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000024605-32.png\",\"created\":\"10\\/13\\/2013\",\"url\":\"\\/game\\/display\\/24605-yhtdukb\"},{\"id\":31742351,\"name\":\"TD5000\",\"desc\":\"Place guns to kill the enemy before they reach your base!\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000025972-32.png\",\"created\":\"10\\/13\\/2013\",\"url\":\"\\/game\\/display\\/25972-td5000\"},{\"id\":31912209,\"name\":\"DTD shooter game\",\"desc\":\"none\",\"image\":\"https:\\/\\/kh-gameimages-us.s3.amazonaws.com\\/000000026111-32.png\",\"created\":\"10\\/13\\/2013\",\"url\":\"\\/game\\/display\\/26111-dtd_shooter_game\"}]";
            try
            {
                List<KongHackTrainer.GameJSON> gs = new List<KongHackTrainer.GameJSON>();
                gs = new System.Web.Script.Serialization.JavaScriptSerializer().Deserialize<List<KongHackTrainer.GameJSON>>(res);
                Game_lb.Items.Clear();
                foreach (KongHackTrainer.GameJSON g in gs)
                {
                    GameSelect_GameItem Item = new GameSelect_GameItem();
                    Item.SetContent(g.name.Trim(), g.desc.Trim(), g.id);
                    Game_lb.Items.Add(Item);
                }
                GameSearchButton.IsEnabled = true;
                GameSearch_tb.IsEnabled = true;
            } catch (Exception e)
            {
                Console.WriteLine(e.Message);
                Console.WriteLine(e.StackTrace);
                GameSearchButton.IsEnabled = true;
                GameSearch_tb.IsEnabled = true;
            }
        }

        private void Game_lb_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            if (Game_lb.Items.Count <= 0) return;
            GameSelect_GameItem ModifiedItem = ((GameSelect_GameItem)e.AddedItems[0]);
            ModifiedItem.ProccessItem_Grid.Background = (Brush)(new BrushConverter()).ConvertFromString("#dadfe1");
            e.AddedItems[0] = ModifiedItem;
            SelectedGameID = ModifiedItem.GameID;
            if (e.RemovedItems.Count > 0) e.RemovedItems[0] = (((GameSelect_GameItem)e.RemovedItems[0]).ProccessItem_Grid.Background = Brushes.Transparent);
        }

        private void GameSearch_tb_PreviewKeyDown(object sender, KeyEventArgs e)
        {
            if (e.Key == Key.Enter)
            {
                TrySearch();
            }
        }

        private void KH_SearchButton_PreviewMouseDown(object sender, MouseButtonEventArgs e)
        {
            TrySearch();
        }
        public void TrySearch()
        {
            if (GameSearch_tb.Textbox.Text.Length > 2)
            {
                GameSearchWorker.RunWorkerAsync(GameSearch_tb.Textbox.Text);
                GameSearchButton.IsEnabled = false;
                GameSearch_tb.IsEnabled = false;
            }
        }

        private void Game_lb_MouseDoubleClick(object sender, MouseButtonEventArgs e)
        {
            RequestSwitchEvent(this, new RequestSwitchArgs("aob"));
        }
    }
}
